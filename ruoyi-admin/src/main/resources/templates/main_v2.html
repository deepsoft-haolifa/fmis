<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--360浏览器优先以webkit内核解析-->
  <title>北京好利</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
  <link href="../static/css/font-awesome.min.css" th:href="@{/css/font-awesome.min.css}" rel="stylesheet"/>
  <link href="../static/css/main/animate.min.css" th:href="@{/css/main/animate.min.css}" rel="stylesheet"/>
  <link href="../static/css/main/style.min862f.css" th:href="@{/css/main/style.min862f.css}" rel="stylesheet"/>
  <script th:src="@{/js/jquery.min.js}"></script>
  <script th:src="@{/ruoyi/js/ry-ui.js?v=4.0.0}"></script>

</head>

<body class="gray-bg">

<div class="row  border-bottom white-bg dashboard-header">
  欢迎访问 北京好利信息化管控平台
  <ul class="m-b">

    <li style="display: none"><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 报价单 <a id="quotationNum" style="color: red;" onclick="todoQuotation(1)"></a> </li>
    <li style="display: none"><i class="fa fa-arrow-circle-o-right m-r-xs"></i> 合同 <a id="contractNum" style="color: red;" onclick="todoContract(1)"></a> </li>

  </ul>

  <div class="form-horizontal">
    <div class="form-group">
      <div class="col-sm-5">
        <table  id="bootstrap-table1"></table>
      </div>
      <div class="col-sm-5">
        <table  id="bootstrap-table2"></table>
      </div>
    </div>

  </div>
</div>

<form id="formId">

</form>


<script th:src="@{/js/jquery.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/ajax/libs/layer/layer.min.js}"></script>
<div th:include="include :: footer"></div>
<script th:inline="javascript">
    var prefix = "/fmis/quotation/";

    function todoQuotation (type) {
        if (type == 1) {
            var url = "/fmis/quotation/todoQuotation";
            location.href = url;
            //$.modal.openTab("待办列表", url);
        }
    }

    function todoContract (type) {
        if (type == 1) {
            var url = "/fmis/data?todo=1";
            location.href = url;
            //parent.modal.open("aaa", url);
            //$.modal.open("aaa", url);
            //$.modal.alertError("1111");
        }
    }
    var loginId = /*[[${loginId}]]*/;
    $(function(){
        //请求参数
        var list = {};
        //
        $.ajax({
            //请求方式
            type : "POST",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //请求地址
            url : prefix + "todoView",
            dataType: 'json',
            //请求成功
            success : function(result) {
                var quotationNum = result.data.quotationNum;
                var contractNum = result.data.contractNum;
                $("#quotationNum").text(quotationNum);
                $("#contractNum").text(contractNum);
                console.log("result=" + result.data.quotationNum);
                if (quotationNum > 0 || contractNum > 0) {
                    parent.$('#todoListFlag').text("*");
                }
            },
            //请求失败，包含具体的错误信息
            error : function(e){
                console.log(e.status);
                console.log(e.responseText);
            }
        });
    });


    $('#pay-qrcode').click(function () {
        var html = $(this).html();
        parent.layer.open({
            title: false,
            type: 1,
            closeBtn: false,
            shadeClose: true,
            area: ['600px', 'auto'],
            content: html
        });
    });
    function goQuotation () {
        $.modal.openTab("报价单审批","/fmis/quotation/todoQuotation");
    }
    $(function() {
        var options = {
            url: "/fmis/quotation/list",
            modalName: "报价单",
            uniqueId: "quotationId",
            id: "bootstrap-table1",
            classes: "table table-bordered table-sm",
            queryParams: {
                "string6":1
            },
            showFooter: true,
            columns: [
                {
                    field : 'quotationId',
                    title : 'ID',
                    visible: false
                },
                {
                    field : 'createBy',
                    title : '申请人',
                    footerFormatter:function (value) {

                        return "<a onclick='goQuotation()' href='#'>更多报价单...</a>";
                    }
                },
                {
                    field : 'string9',
                    title : '总金额'
                },
                {
                    field : 'createTime',
                    title : '创建时间'
                }]
        };
        $.table.init(options);
    });

    $(function(){
        //请求参数
        var list = {};
        //
        $.ajax({
            //请求方式
            type : "POST",
            //请求的媒体类型
            contentType: "application/json;charset=UTF-8",
            //请求地址
            url : prefix + "todoView",
            dataType: 'json',
            //请求成功
            success : function(result) {
                var quotationNum = result.data.quotationNum;
                var contractNum = result.data.contractNum;
                $("#quotationNum").text(quotationNum);
                $("#contractNum").text(contractNum);
                console.log("result=" + result.data.quotationNum);
                if (quotationNum > 0 || contractNum > 0) {
                    parent.$('#todoListFlag').text("*");
                }
            },
            //请求失败，包含具体的错误信息
            error : function(e){
                console.log(e.status);
                console.log(e.responseText);
            }
        });
    });


    $('#pay-qrcode').click(function () {
        var html = $(this).html();
        parent.layer.open({
            title: false,
            type: 1,
            closeBtn: false,
            shadeClose: true,
            area: ['600px', 'auto'],
            content: html
        });
    });

    function goContract () {
        $.modal.openTab("合同审批","/fmis/data?todo=1");
    }

    $(function() {
        var options = {
            url: "/fmis/data/list",
            id: "bootstrap-table2",
            classes: "table table-bordered table-sm",
            modalName: "合同管理",
            queryParams: {
                "queryStatus":1
            },
            showFooter: true,
            uniqueId: "dataId",
            columns: [
                {
                    field : 'dataId',
                    title : 'ID',
                    visible: false
                },
                {
                    field : 'createByName',
                    title : '申请人',
                    footerFormatter:function (value) {
                        return "<a onclick='goContract()' href='#'>更多合同...</a>";
                    }
                },
                {
                    field : 'price1',
                    title : '总价'
                },
                {
                    field : 'createTime',
                    title : '创建时间'
                }]
        };
        $.table.init(options);
    });

</script>
</body>
</html>
